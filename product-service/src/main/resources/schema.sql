DROP TABLE IF EXISTS P_PRODUCTS_STOCK_HISTORY;
DROP TABLE IF EXISTS P_PRODUCTS;

CREATE TABLE P_PRODUCTS (
    PRODUCT_ID BIGINT GENERATED BY DEFAULT AS IDENTITY
                PRIMARY KEY,
    PRODUCT_UUID            VARCHAR(36) NOT NULL UNIQUE,
    COMPANY_ID              VARCHAR(36) NOT NULL,
    PRODUCT_HUB_ID          VARCHAR(36) NOT NULL,
    PRODUCT_NAME            VARCHAR(255) NOT NULL,
    PRODUCT_PRICE           BIGINT NOT NULL,
    PRODUCT_DESCRIPTION     VARCHAR(255) NOT NULL,
    STOCK_QUANTITY          INTEGER NOT NULL,
    VERSION                 BIGINT NOT NULL,
    IS_DELETE               BOOLEAN NOT NULL DEFAULT FALSE,
    IS_PUBLIC               BOOLEAN NOT NULL DEFAULT FALSE,
    CREATED_AT              TIMESTAMP(6) DEFAULT NULL,
    CREATED_BY              VARCHAR(36) DEFAULT NULL,
    UPDATED_AT              TIMESTAMP(6) DEFAULT NULL,
    UPDATED_BY              VARCHAR(36) DEFAULT NULL,
    DELETED_AT              TIMESTAMP(6) DEFAULT NULL,
    DELETED_BY              VARCHAR(36) DEFAULT NULL
);

CREATE TABLE P_PRODUCTS_STOCK_HISTORY
(
    PRODUCT_STOCK_HISTORY_ID BIGINT GENERATED BY DEFAULT AS IDENTITY
        PRIMARY KEY,
    PRODUCT_ID               BIGINT,
    STOCK_TYPE VARCHAR(8)
        CONSTRAINT P_PRODUCTS_STOCK_HISTORY_STOCK_TYPE_CHECK
            CHECK (STOCK_TYPE IN ('INBOUND', 'OUTBOUND', 'CANCEL')),
    QUANTITY                 BIGINT,
    IS_DELETE                BOOLEAN DEFAULT FALSE NOT NULL,
    IS_PUBLIC                BOOLEAN DEFAULT FALSE NOT NULL,
    CREATED_AT               TIMESTAMP(6),
    CREATED_BY               VARCHAR(36),
    UPDATED_AT               TIMESTAMP(6),
    UPDATED_BY               VARCHAR(36),
    DELETED_AT               TIMESTAMP(6),
    DELETED_BY               VARCHAR(36)
);
